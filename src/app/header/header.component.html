<nav class="navbar navbar-default navbar-pf" role="navigation" *ngIf="loggedIn">
  <div class="collapse navbar-collapse navbar-collapse-1">
    <ul class="nav navbar-nav navbar-primary persistent-secondary">
      <!-- This part of the menu is dynamic based on context -->
      <li class="context dropdown" dropdown>
        <a dropdown-open>
          <span *ngIf="!router.url.startsWith('/analyze')">
            pmuir
          </span>
          <span *ngIf="router.url.startsWith('/analyze')">
            BalloonPopGame
          </span>
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li>
            <a [routerLink]="['/analyze']">BalloonPopGame</a>
          </li>
          <li>
            <a>BalloonPopGame / UX Team</a>
          </li>
          <li>
            <a>Red Hat Organization</a>
          </li>
          <li>
            <a [routerLink]="['/profile/spaces']">Browse all</a>
          </li>
          <li class="divider"></li>
          <li>
            <a [routerLink]="['/home']">Account home</a>
          </li>
          <li>
            <!-- TODO: This should pop up the new space dialog -->
            <a>New space</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="!router.url.startsWith('/analyze')">
        <a [routerLink]="['/home']" id="header_menuHome">Home</a>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="!router.url.startsWith('/analyze')">
        <a [routerLink]="['/profile']">Profile</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact:true}">
            <a [routerLink]="['/profile']">Profile</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/profile/spaces']">Collaboration Spaces</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/profile/resources']">Resources</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}" *ngIf="router.url.startsWith('/analyze')">
        <a [routerLink]="['/analyze']" id="header_menuAnalyze">Analyze</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}">
            <a [routerLink]="['/analyze']">Overview</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/readme']">README</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="router.url.startsWith('/analyze')">
        <a [routerLink]="['/analyze/plan']">Plan</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}">
            <a [routerLink]="['/analyze/plan']">Backlog</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/plan/board']">Board</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="router.url.startsWith('/analyze')">
        <a [routerLink]="['/analyze/create']">Create</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}">
            <a [routerLink]="['/analyze/create']">Codebases</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/create/workspaces']">Workspaces</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="router.url.startsWith('/analyze')">
        <a [routerLink]="['/analyze/run']">Run</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/run']">Pipelines</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="router.url.startsWith('/analyze')">
        <a [routerLink]="['/analyze/settings']" id="header_menuSettings" routerLinkActive="active"><span class="pficon pficon-settings"></span></a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}">
            <a [routerLink]="['/analyze/settings']">Overview</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/settings/work']">Work</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/settings/security']">Security</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/settings/alerts']">Alerts</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="!router.url.startsWith('/analyze')">
        <a [routerLink]="['/settings']" id="header_menuSettings" routerLinkActive="active"><span class="pficon pficon-settings"></span></a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}">
            <a [routerLink]="['/settings']">Profile</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/settings/account']">Account</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/settings/emails']">Emails</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/settings/notifications']">Notifications</a>
          </li>
        </ul>
      </li>
      <!-- end dynamic section -->
    </ul>
  </div>
  <div class="navbar-collapse navbar-collapse-1 nav-mob-scroll">
    <ul id="header_rightDropdown" class="nav navbar-nav navbar-utility">
      <li *ngIf="loggedIn" dropdown class="pull-right dropdown">
        <a dropdown-open>
          <a *ngIf="loggedInUser" id="header_dropdownToggle">
            <span *ngIf="!imgLoaded" class="pficon pficon-user"></span>
            <img (load)="onImgLoad()" src="{{ loggedInUser.attributes?.imageURL }}" [ngClass]="{'show' : imgLoaded,'img-icon' : imgLoaded, 'hide' : !imgLoaded}"
              class="pull-left marginR10" /> {{loggedInUser.attributes?.fullName}}
          </a>
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li>
            <a [routerLink]="['/profile']">Profile</a>
          </li>
          <li>
            <a href="https://fabric8.io/guide/getStarted/index.html">Help</a>
          </li>
          <li class="divider"></li>
          <li>
            <a [routerLink]="['/settings']">Settings</a>
          </li>
          <li>
            <a *ngIf="loggedIn" (click)='logout();'>Sign out</a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</nav>
