<nav class="navbar navbar-default navbar-pf" role="navigation">
  <div class="collapse navbar-collapse navbar-collapse-1">
    <ul class="nav navbar-nav navbar-primary persistent-secondary"  >
      <!-- This part of the menu is dynamic based on context -->
      <li [routerLinkActive]="['active']" *ngIf="!router.url.startsWith('/analyze')">
        <a>pmuir <b class="caret"></b></a>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="!router.url.startsWith('/analyze')">
        <a [routerLink]="['/home']" id="header_menuHome">Home</a>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="!router.url.startsWith('/analyze')">
        <a [routerLink]="['/profile']" >Profile</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact:true}">
            <a [routerLink]="['/profile']">Profile</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/profile/spaces']">Collaboration Spaces</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/profile/resources']" >Resources</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="router.url.startsWith('/analyze')">
        <a>BalloonPopGame <b class="caret"></b></a>
      </li>
      <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}" *ngIf="router.url.startsWith('/analyze')">
        <a [routerLink]="['/analyze']" id="header_menuAnalyze">Analyze</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}">
            <a [routerLink]="['/analyze']">Overview</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/readme']">README</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="router.url.startsWith('/analyze')">
        <a [routerLink]="['/analyze/plan']" >Plan</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}">
            <a [routerLink]="['/analyze/plan']">Backlog</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/plan/board']">Board</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="router.url.startsWith('/analyze')">
        <a [routerLink]="['/analyze/create']" >Create</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}">
            <a [routerLink]="['/analyze/create']">Codebases</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/create/workspaces']">Workspaces</a>
          </li>
        </ul>
      </li>
      <li [routerLinkActive]="['active']" *ngIf="router.url.startsWith('/analyze')">
        <a [routerLink]="['/analyze/run']" >Run</a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/analyze/run']">Pipelines</a>
          </li>
        </ul>
      </li>
      <!-- end dynamic section -->
      <li [routerLinkActive]="['active']">
        <a [routerLink]="['/settings']" id="header_menuSettings" routerLinkActive="active"><span class="pficon pficon-settings"></span></a>
        <ul class="nav navbar-nav navbar-persistent">
          <li [routerLinkActive]="['active']" [routerLinkActiveOptions]="{exact: true}">
            <a [routerLink]="['/settings']">Overview</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/settings/work']">Work</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/settings/security']">Security</a>
          </li>
          <li [routerLinkActive]="['active']">
            <a [routerLink]="['/settings/alerts']">Alerts</a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
  <div class="navbar-collapse navbar-collapse-1 nav-mob-scroll">
    <ul id="header_rightDropdown" class="nav navbar-nav navbar-utility">
      <!-- temporary hack by pmuir to fix POC UX until we implement log in screens -->
      <li dropdown class="pull-right dropdown">
        <a dropdown-open>
          <a id="header_dropdownUtility">
            <span *ngIf="!imgLoaded" class="pficon pficon-user"></span>
            <img (load)="onImgLoad()" src="https://avatars2.githubusercontent.com/u/157761?v=3&s=460"
                 [ngClass]="{'show' : imgLoaded,'img-icon' : imgLoaded, 'hide' : !imgLoaded}"
                 class="pull-left marginR10" />
            pmuir
          </a>
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li>
            <a [routerLink]="['/profile']" >Profile</a>
          </li>
          <li>
            <a [routerLink]="['/help']" >Help</a>
          </li>
          <li class="divider"></li>
          <li>
            <a [routerLink]="['/settings']" >Settings</a>
          </li>
          <li>
            <a>Sign out</a>
          </li>
        </ul>
      </li>
      <!-- End of pmuir's hack -->
      <li *ngIf="loggedIn" dropdown class="pull-right dropdown">
        <a dropdown-open>
          <a *ngIf="loggedInUser" id="header_dropdownToggle">
            <span *ngIf="!imgLoaded" class="pficon pficon-user"></span>
            <img (load)="onImgLoad()" src="{{ loggedInUser.attributes?.imageURL }}"
                 [ngClass]="{'show' : imgLoaded,'img-icon' : imgLoaded, 'hide' : !imgLoaded}"
                 class="pull-left marginR10" />
            {{loggedInUser.attributes?.fullName}}
          </a>
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li>
            <a [routerLink]="['/profile']" >Profile</a>
          </li>
          <li>
            <a [routerLink]="['/help']" >Help</a>
          </li>
          <li class="divider"></li>
          <li>
            <a [routerLink]="['/settings']" >Settings</a>
          </li>
          <li>
            <a *ngIf="loggedIn" (click)='logout();'>Sign out</a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</nav>