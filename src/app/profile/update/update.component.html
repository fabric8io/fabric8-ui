<div id="overview" class="container-fluid content">
  <div class="row profile-edit-masthead">
    <div class="col-xs-12 col-md-1">
      <div *ngIf="(context.user.attributes.imageURL !== undefined && context.user.attributes.imageURL.length !== 0); then showImageURL else addImageURL"></div>
      <ng-template #showImageURL>
        <img src="{{context.user.attributes.imageURL}}" class="img-responsive profile-img icon-user">
      </ng-template>
      <ng-template #addImageURL>
        <img src="../../../assets/images/profile-user.png" class="img-responsive profile-img-none">
      </ng-template>
    </div>

    <div class="col-xs-12 col-md-10">
      <div class="col-xs-12 col-md-12 padding-bottom-15">
        <p class="col-md-12"><label for="previewImg" class="control-label padding-left-none">Profile photo</label></p>
        <p class="col-md-3 link-profile-photo">
          <a href="javascript:void(0)" (click)="linkImageUrl()">
            <span class="fa fa-gravatar"></span> Import from Gravatar
          </a>
        </p>
        <p class="col-md-3 link-profile-photo">
          <a href="javascript:void(0)" (click)="linkImageUrl()">
            <span class="fa fa-github"></span> Import from Github
          </a>
        </p>
      </div>
      <form class="col-xs-12 col-md-9" role="form" #profileForm="ngForm">
        <div class="col-xs-12 col-md-7">
            <div class="form-group">
            <label for="fullName" class="control-label">Name</label>
            <div [ngClass]="{'has-error': fullNameInvalid}">
              <input type="text" class="form-control" id="fullName" name="fullName"
                      placeholder="Enter your full name"
                      [maxLength]="80"
                      [(ngModel)]="fullName">
            </div>
          </div>
          <div class="form-group">
            <label for="email" class="control-label required-pf email-alignment-label">Email</label>
            <div [ngClass]="{'has-error': emailInvalid}" class="email-alignment">
              <input type="email" class="form-control" id="email" name="email" #_email
                      placeholder="name@gmail.com"
                      [maxLength]="255"
                      [(ngModel)]="email"
                      (change)="validateEmail()">
              <div class="radio email-alignment_settings">
                <label>
                  <input type="radio" name="emailVisibility" id="emailPrivate"
                          [(ngModel)]="emailPrivate"
                          [value]="true"
                          [checked]="emailPrivate">
                  Private
                </label>
                <label class="margin-left-30">
                  <input type="radio" name="emailVisibility" id="emailPublic"
                          [(ngModel)]="emailPrivate"
                          [value]="false"
                          [checked]="!emailPrivate">
                  Public
                </label>

              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="company" class="control-label">Company</label>
            <div [ngClass]="{'has-error': companyInvalid}">
              <input type="text" class="form-control" id="company" name="company"
                      placeholder="Enter your company's name"
                      [maxLength]="80"
                      [(ngModel)]="company">
            </div>
          </div>
          <div class="form-group">
            <label for="url" class="control-label">URL</label>
            <div [ngClass]="{'has-error': urlInvalid}">
              <input type="text" class="form-control" id="url" name="url" #_url
                    placeholder="http://www.myprofile.com"
                    [maxLength]="255"
                    [(ngModel)]="url"
                    (change)="validateUrl()">
            </div>
          </div>
          <div class="padding-top-20">
            <button class="btn btn-primary btn-update col-md-3"
              [disabled]="isUpdateProfileDisabled"
              (click)="updateProfile()">Update</button>
            <button class="btn btn-cancel btn-default col-md-2"
              (click)="routeToProfile()">Cancel</button>
          </div>
        </div>
        <div class="form-group">
          <label for="bioInput">Bio</label>
          <textarea class="form-control" id="bioInput" name="bioInput" rows="5" #_bio
                    placeholder="Enter your bio"
                    [blockInputAtMaxLimit]="true"
                    [charsMaxLimit]="255"
                    [charsRemainingElement]="remainingCountElement"
                    [charsRemainingWarning]="5"
                    (onOverCharsMaxLimit)="handleOverCharsMaxLimit()"
                    [(ngModel)]="bio"
                    pfng-remaining-chars-count>
          </textarea>
          <span class="pull-right chars-remaining-pf">
            <span #remainingCountElement></span>
            <span class="fields-status-pf">characters remaining</span>
          </span>
        </div>
        <div class="form-group">
          <button class="btn btn-default" id="passwordReset" (click)="resetPasswordUrl()">
            Change password <i class="fa fa-external-link"></i>
          </button>
        </div>
      </form>

      <form class="col-xs-12 col-md-3" role="form" #advancedForm="ngForm">
        <div class="form-group">
          <label for="token" class="control-label">Personal Access Token</label>
          <div class="panel panel-default" id="token">
            <div class="panel-heading token-heading-cont">
              <i class="padding-top-13 fa"
                [ngClass]="{'fa-angle-down': tokenPanelOpen, 'fa-angle-right': !tokenPanelOpen}"
                (click)="toggleTokenPanel()"></i>
              <p class="token-heading padding-top-10 padding-right-15 margin-right-5"
                [ngClass]="{'padding-left-11': tokenPanelOpen, 'padding-left-15': !tokenPanelOpen}">{{token}}</p>
              <button class="btn btn-lg btn-default"
                      (click)="copyTokenToClipboard()">Copy</button>
            </div>
            <div class="panel-body margin-left-15 margin-right-15" *ngIf="tokenPanelOpen">
              <p class="token-body padding-left-5 padding-right-5">{{token}}</p>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12">
            <button class="btn btn-default" (click)="updateTenant()" [disabled]="updateTenantStatus === TenantUpdateStatus.Updating">Update Tenant</button>
            <button class="btn btn-default" (click)="cleanupTenant()">Reset Environment</button>
          </div>
          <div class="col-xs-12 update-tenant-status padding-top-20" *ngIf="updateTenantStatus !== TenantUpdateStatus.NoAction">
            <div *ngIf="updateTenantStatus === TenantUpdateStatus.Updating">
              <span class="spinner spinner-xs spinner-inline fa-spin"></span>
              <span class="">Updating tenant</span>
            </div>
            <div *ngIf="updateTenantStatus === TenantUpdateStatus.Success">
              <div class="text-success">
                <span class="fa fa-check update-icon-padding"></span>Updated tenant
              </div>
            </div>
            <div *ngIf="updateTenantStatus === TenantUpdateStatus.Failure">
              <div class="text-danger">
                <span class="pficon-close update-icon-padding"></span>Failed to update tenant
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
